<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistema de Monitoramento de Campanhas</title>

    <!-- Fontes e libs -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        :root{
            --bg:#eef1f5;
            --box:#ffffff;
            --texto:#000000;
            --primaria:#4A73F3;
            --tabela:#ffffff;
        }
        body.dark{
            --bg:#1e1e1e;
            --box:#2b2b2b;
            --texto:#ffffff;
            --primaria:#6a95ff;
            --tabela:#3a3a3a;
        }

        body { font-family:'Poppins',sans-serif; background:var(--bg); color:var(--texto); margin:0; padding:0; transition:0.3s; }
        header { background:var(--primaria); color:white; padding:20px; text-align:center; font-size:24px; font-weight:600; }
        .box { max-width:900px; margin:40px auto; background:var(--box); padding:30px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.2); transition:0.3s; }
        h2 { text-align:center; }
        label { font-weight:600; display:block; margin-top:10px; }
        input { width:100%; padding:10px; margin-bottom:15px; border-radius:8px; border:1px solid #ccc; }
        button { padding:12px 18px; background:var(--primaria); color:white; border:none; border-radius:8px; cursor:pointer; }
        button:hover { opacity:0.9; }
        table { width:100%; border-collapse:collapse; margin-top:25px; background:var(--tabela); transition:0.3s; }
        th { background:var(--primaria); color:white; padding:12px; }
        td { padding:12px; border-bottom:1px solid #ddd; text-align:center; }
        .grafico-box { margin-top:40px; }

        #temaBtn{ position:absolute; top:20px; right:20px; padding:10px 16px; background:#222; color:white; border-radius:8px; cursor:pointer; }
    </style>
</head>
<body>

<header>Sistema de Monitoramento de Campanhas</header>
<button id="temaBtn">üåô Tema Escuro</button>

<div class="box">
    <h2>Adicionar Campanha</h2>

    <label>M√≠dia</label><input type="text" id="midia">
    <label>Custo (R$)</label><input type="number" id="custo">
    <label>Resultados</label><input type="number" id="resultados">
    <label>Alcance</label><input type="number" id="alcance">

    <button onclick="adicionarCampanha()">Adicionar</button>
    <button onclick="exportarExcel()" style="background:#0a9c4a; margin-left:10px;">Exportar Excel</button>

    <table>
        <thead>
            <tr>
                <th>M√≠dia</th><th>Custo</th><th>Resultados</th><th>Alcance</th><th>ROI</th><th>Remover</th>
            </tr>
        </thead>
        <tbody id="tabela"></tbody>
    </table>

    <div class="grafico-box"><h2>Gr√°fico de Alcance</h2><canvas id="graficoAlcance"></canvas></div>
    <div class="grafico-box"><h2>Gr√°fico de Custo</h2><canvas id="graficoCusto"></canvas></div>
    <div class="grafico-box"><h2>Gr√°fico de Resultados</h2><canvas id="graficoResultados"></canvas></div>
    <div class="grafico-box"><h2>Gr√°fico de ROI</h2><canvas id="graficoROI"></canvas></div>
</div>

<script>
    let campanhas = [];
    let gAlcance, gCusto, gResultados, gROI;

    document.getElementById('temaBtn').onclick = ()=>{
        document.body.classList.toggle('dark');
        temaBtn.textContent = document.body.classList.contains('dark') ? '‚òÄÔ∏è Tema Claro' : 'üåô Tema Escuro';
    };

    function adicionarCampanha() {
        const midiaVal = document.getElementById('midia').value;
        const custoVal = document.getElementById('custo').value;
        const resultadosVal = document.getElementById('resultados').value;
        const alcanceVal = document.getElementById('alcance').value;

        if(!midiaVal || !custoVal || !resultadosVal || !alcanceVal)
            return alert('Preencha todos os campos');

        const roi = (resultadosVal - custoVal) / custoVal;

        campanhas.push({ midia: midiaVal, custo: custoVal, resultados: resultadosVal, alcance: alcanceVal, roi });

        atualizarTabela();
        atualizarGraficos();
        limparCampos();
    }

    function limparCampos(){
        document.getElementById('midia').value = '';
        document.getElementById('custo').value = '';
        document.getElementById('resultados').value = '';
        document.getElementById('alcance').value = '';
    }

    function remover(i){
        campanhas.splice(i,1);
        atualizarTabela();
        atualizarGraficos();
    }

    function atualizarTabela(){
        const tabela = document.getElementById('tabela');
        tabela.innerHTML = '';

        campanhas.forEach((c,i)=>{
            tabela.innerHTML += `
                <tr>
                    <td>${c.midia}</td>
                    <td>R$ ${c.custo}</td>
                    <td>${c.resultados}</td>
                    <td>${c.alcance}</td>
                    <td>${(c.roi*100).toFixed(1)}%</td>
                    <td><button onclick="remover(${i})" style="background:red">X</button></td>
                </tr>`;
        });
    }

    function criarGrafico(canvas, label, dados){
        if(!canvas) return;
        return new Chart(canvas.getContext('2d'), {
            type:'bar',
            data:{ labels: campanhas.map(c=>c.midia), datasets:[{ label, data:dados }] }
        });
    }

    function atualizarGraficos(){
        if(gAlcance) gAlcance.destroy();
        if(gCusto) gCusto.destroy();
        if(gResultados) gResultados.destroy();
        if(gROI) gROI.destroy();

        gAlcance = criarGrafico(document.getElementById('graficoAlcance'), 'Alcance', campanhas.map(c=>c.alcance));
        gCusto = criarGrafico(document.getElementById('graficoCusto'), 'Custo', campanhas.map(c=>c.custo));
        gResultados = criarGrafico(document.getElementById('graficoResultados'), 'Resultados', campanhas.map(c=>c.resultados));
        gROI = criarGrafico(document.getElementById('graficoROI'), 'ROI', campanhas.map(c=>c.roi));
    }

    function exportarExcel(){
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.json_to_sheet(campanhas);
        XLSX.utils.book_append_sheet(wb, ws, "Campanhas");
        XLSX.writeFile(wb, "campanhas.xlsx");
    }
</script>

</body>
</html>